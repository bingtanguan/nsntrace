<?xml version='1.0'?> <!--*-nxml-*-->
<!DOCTYPE refentry PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN"
"http://www.oasis-open.org/docbook/xml/4.2/docbookx.dtd">

<refentry id="nsntrace" xmlns:xi="http://www.w3.org/2001/XInclude">

  <refentryinfo>
    <title>nsntrace</title>
    <productname>nsntrace</productname>

    <authorgroup>
      <author>
	<contrib>Developer</contrib>
	<firstname>Jonas</firstname>
	<surname>Danielsson</surname>
	<email>jonas@threetimestwo.org</email>
      </author>
    </authorgroup>
  </refentryinfo>

  <refmeta>
    <refentrytitle>nsntrace</refentrytitle>
    <manvolnum>1</manvolnum>
  </refmeta>

  <refnamediv>
    <refname>nsntrace</refname>
    <refpurpose>
      Perform a network trace of a process by using Linux network namespaces
    </refpurpose>
  </refnamediv>

  <refsynopsisdiv>
    <cmdsynopsis>
      <command>nsntrace</command>
      <arg choice="opt" rep="repeat">OPTIONS</arg>
      <arg>PROG</arg>
      <arg choice="opt">ARGS</arg>
    </cmdsynopsis>
  </refsynopsisdiv>

  <refsect1>
    <title>Description</title>

    <para><command>nsntrace</command> uses Linux network namespaces to
    perform network traces of a single application. The traces are saved as
    pcap files. And can later be analyzed by applications such as
    <command>wireshark</command>.</para>

    <para><command>nsntrace</command> creates a new network namespace and
    launches the specified program in it. This will ensure that all
    the packets we trace come from the system or the specified program.</para>

    <para>To get around the isolation caused by the network namespace a
    virtual network interface is created. And in order for the programs
    traffic to reach the root network namespace <command>iptables</command>
    is used.</para>

    <para>Since <command>nsntrace</command> uses iptables and traces raw
    sockets it needs to be run as root.</para>
  </refsect1>

  <refsect1>
    <title>Options</title>

    <para>The following options are understood:</para>


    <variablelist>
      <varlistentry>
	<term><option>--device <replaceable>DEV</replaceable></option></term>
	<term><option>-d <replaceable>DEV</replaceable></option></term>

	<listitem><para>
	  The network device to use in trace.
	</para></listitem>
      </varlistentry>

      <varlistentry>
	<term><option>--outfile <replaceable>FILE</replaceable></option></term>
	<term><option>-f <replaceable>FILE</replaceable></option></term>

	<listitem><para>
	  Write the trace output to the file <replaceable>FILE</replaceable>.
	  Default is nsntrace.pcap.
	</para></listitem>
      </varlistentry>

      <varlistentry>
	<term><option>--user <replaceable>USER</replaceable></option></term>
	<term><option>-u <replaceable>USER</replaceable></option></term>

	<listitem><para>
	  Run program with the user ID, group ID and supplementary groups
	  of <replaceable>USER</replaceable>.
	</para></listitem>
      </varlistentry>

      <varlistentry>
	<term><option>
	  --filter <replaceable>FILTER</replaceable></option></term>
	<term><option>-f <replaceable>FILTER</replaceable></option></term>

	<listitem><para>
	  The capture filter to use while capturing. See <citerefentry>
	  <refentrytitle>pcap-filter</refentrytitle><manvolnum>7</manvolnum>
	  </citerefentry> for filter syntax.
	</para></listitem>
      </varlistentry>

      </variablelist>
  </refsect1>

  <refsect1>
    <title>Exit status</title>

    <para>On success, 0 is returned; otherwise, a non-zero failure
    code is returned.</para>
  </refsect1>
</refentry>
